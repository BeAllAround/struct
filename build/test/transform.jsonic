

basic: {
  in: { data: {a:1}, spec: {a:'`a`'}, store: {} }
  out: {a:1}
}


paths: {
  set: [
  # { in: { data:{a:{b:1}}, spec:{} }, out: {} }
  #  { in: { data:{a:{b:2}}, spec:{x:2} }, out: {x:2} }
    { in: { data:{a:{b:3}}, spec:{x:'`a`'} }, out: {x:{b:3}} }
    { in: { data:{a:{b:4}}, spec:{x:'`a.b`'} }, out: {x:4} }
    { in: { data:{a:{b:5}}, spec:{x:'`b`'} }, out: {} }
    { in: { data:{a:{b:6}}, spec:{x:'`a.c`'} }, out: {} }

    { in: { data:{a:{b:7,c:'C'}}, spec:{x:'`a.b``a.c`'} }, out: {x:'7C'} }
    { in: { data:{a:{b:8},c:9}, spec:{x:'`a.b`'} }, out: {x:8} }
    { in: { data:{d:10,a:{b:11},c:12}, spec:{x:'`a.b`'} }, out: {x:11} }
    { in: { data:{d:13,a:{b:14}}, spec:{x:'`a.b`'} }, out: {x:14} }

    { in: { data:{a:{b:'B',c:'C'}}, spec:{a:{d:'`.b`'}} }, out: {a:{d:'B'}} }
    { in: { data:{a:{b:{c:'C'}}}, spec:{a:{d:'`.b.c`'}} }, out: {a:{d:'C'}} }
  ]
}


cmds: {
  set: [
    { in: { data:{a:{b:1}}, spec:{a:'`$COPY`'} }, out: {a:{b:1}} }

    { in: { data:{a:{b:2}}, spec:{a:{b:'`$COPY`'}} }, out: {a:{b:2}} }
    { in: { data:{a:[21,22]}, spec:{a:'`$COPY`'} }, out: {a:[21,22]} }
    { in: { data:{a23:true}, spec:{a23:'`$COPY`', a24:'`$COPY`'} },
      out: {a23:true} }
    
    { in: { data:{a:{b:3}}, spec:{a:{'`$MERGE`':'`a`',c:3}} }, out: {a:{b:3,c:3}} }
    { in: { data:{a:{b:4}}, spec:{'`$MERGE`':''} }, out: {a:{b:4}} }
    { in: { data:{a:{b:5}}, spec:{a:{'`$MERGE`':'`a`',b:51}} }, out: {a:{b:5}} }
    { in: { data:{a:{b:6}}, spec:{a:{b:61,'`$MERGE`':'`a`'}} }, out: {a:{b:6}} }

    { in: { data:{a:{b:71},c:{b:81}}, spec:{x:{'`$MERGE`':['`a`']}} }, out: {x:{b:71}} }
    { in: { data:{a:{b:72},c:{b:82}}, spec:{x:{'`$MERGE`':['`a`','`c`']}} }, out: {x:{b:82}} }
    { in: { data:{a:{b:73},c:{b:83}}, spec:{x:{'`$MERGE`':['`c`','`a`']}} }, out: {x:{b:73}} }

    { in: { data:{a:{b:74},c:{b:84}}, spec:{x:{'`$MERGE`':'`a`'}} }, out: {x:{b:74}} }
    { in: { data:{a:{b:75},c:{b:85}}, spec:{x:{'`$0MERGE`':'`a`','`$1MERGE`':'`c`'}} },
      out: {x:{b:85}} }
    { in: { data:{a:{b:76},c:{b:86}}, spec:{x:{'`$1MERGE`':'`a`','`$0MERGE`':'`c`'}} },
      out: {x:{b:76}} }
      
    { in: { data:{a:{b:7}}, spec:{a:{'`$MERGE`':['`a`',{b:71}]}} }, out: {a:{b:71}} }

    { in: { data:{a:{b:8}}, spec:{a:{b:'`$DELETE`'}} }, out: {a:{}} }
    { in: { data:{a:{b:8}}, spec:{a:'`$DELETE`'} }, out: {} }

    { in: { data:{}, spec:{a:'`$BT`$COPY`$BT`'} }, out: {a:'`$COPY`'} }
  ]
}


each: {
  set: [
    { in: { data: {}, spec: {z:['`$EACH`','x',{y:'`$COPY`',q:'Q0'}]} },
      out: {z:[]} }

    { in: { data: {x:{}}, spec: {z:['`$EACH`','x',{y:'`$COPY`',q:'Q1'}]} },
      out: {z:[]} }

    { in: { data: {x:{a:{y:10}}}, spec: {z:['`$EACH`','x',{y:'`$COPY`',q:'Q2'}]} },
      out: {z:[{y:10,q:'Q2'}]} }

    { in: { data: {x:{a:{y:10},b:{y:11}}}, spec: {z:['`$EACH`','x',{y:'`$COPY`',q:'Q3'}]} },
      out: {z:[{y:10,q:'Q3'},{y:11,q:'Q3'}]} }

    { in: { data: {x:{a:{y:10},b:{y:11},c:{y:12}}},
            spec: {z:['`$EACH`','x',{y:'`$COPY`',q:'Q4'}]} },
      out: {z:[{y:10,q:'Q4'},{y:11,q:'Q4'},{y:12,q:'Q4'}]} }

    { in: { data: {x:{a:{y:10},b:{y:11},c:{y:12},d:{y:13}}},
            spec: {z:['`$EACH`','x',{y:'`$COPY`',q:'Q5'}]} },
      out: {z:[{y:10,q:'Q5'},{y:11,q:'Q5'},{y:12,q:'Q5'},{y:13,q:'Q5'}]} }

    { in: { data: {x:{a:{y:10},b:{y:11},c:{y:12},d:{y:13},e:{y:14}}},
            spec: {z:['`$EACH`','x',{y:'`$COPY`',q:'Q6'}]} },
      out: {z:[{y:10,q:'Q6'},{y:11,q:'Q6'},{y:12,q:'Q6'},{y:13,q:'Q6'},{y:14,q:'Q6'}]} }


    { in: { data: {}, spec: ['`$EACH`','x',{y:'`$COPY`',p:'P0'}] },
      out: [] }

    { in: { data: {x:{}}, spec: ['`$EACH`','x',{y:'`$COPY`',p:'P1'}] },
      out: [] }
      
    { in: { data: {x:{a:{y:10}}}, spec: ['`$EACH`','x',{y:'`$COPY`',p:'P2'}] },
      out: [{y:10,p:'P2'}] }
    
    { in: { data: {x:{a:{y:10},b:{y:11}}}, spec: ['`$EACH`','x',{y:'`$COPY`',p:'P3'}] },
      out: [{y:10,p:'P3'},{y:11,p:'P3'}] }

    { in: { data: {x:{a:{y:10},b:{y:11},c:{y:12}}},
            spec: ['`$EACH`','x',{y:'`$COPY`',p:'P4'}] },
      out: [{y:10,p:'P4'},{y:11,p:'P4'},{y:12,p:'P4'}] }

    { in: { data: {x:{a:{y:10},b:{y:11},c:{y:12},d:{y:13}}},
            spec: ['`$EACH`','x',{y:'`$COPY`',p:'P5'}] },
      out: [{y:10,p:'P5'},{y:11,p:'P5'},{y:12,p:'P5'},{y:13,p:'P5'}] }

    { in: { data: {x:{a:{y:10},b:{y:11},c:{y:12},d:{y:13},e:{y:14}}},
            spec: ['`$EACH`','x',{y:'`$COPY`',p:'P6'}] },
      out: [{y:10,p:'P6'},{y:11,p:'P6'},{y:12,p:'P6'},{y:13,p:'P6'},{y:14,p:'P6'}] }


    { in: { data: {x:{p:{a:{y:10}}}},
            spec: {z:['`$EACH`','x.p',{y:'`$COPY`',w:'w0',k:'`$KEY`'}]} },
      out: {z:[{y:10,w:'w0',k:'a'}]} }

    { in: { data: {x:{p:{q:{a:{y:10}}}}},
            spec: {z:['`$EACH`','x.p.q',{y:'`$COPY`',w:'w1',k:'`$KEY`'}]} },
      out: {z:[{y:10,w:'w1',k:'a'}]} }

  ]
}


pack: {
  set: [
    { in: { data: {x:[{y:0,k:'K0'},{y:1,k:'K1'}]},
            spec: {z:{'`$PACK`':['x',{'`$KEY`':'k', y:'`$COPY`',q:'Q0'}]}} },
      out: {z:{K0:{y:0,q:'Q0'},K1:{y:1,q:'Q0'}}} }

    { in: { data: {x:[{y:0,k:'K0'},{y:1,k:'K1'}]},
            spec: {'`$PACK`':['x',{'`$KEY`':'k', y:'`$COPY`',q:'Q1'}]} },
      out: {K0:{y:0,q:'Q1'},K1:{y:1,q:'Q1'}} }

    { in: { data: [{y:0,k:'K0'},{y:1,k:'K1'}],
            spec: {'`$PACK`':['',{'`$KEY`':'k', y:'`$COPY`',q:'Q2'}]} },
      out: {K0:{y:0,q:'Q2'},K1:{y:1,q:'Q2'}} }

    { in: { data: [{y:0,k:'K0'},{y:1,k:'K1'}],
            spec: {z:{'`$PACK`':['',{'`$KEY`':'k', y:'`$COPY`',q:'Q3'}]}} },
      out: {z:{K0:{y:0,q:'Q3'},K1:{y:1,q:'Q3'}}} }
      
  ]
}


modify: {
  set: [
  ]
}
